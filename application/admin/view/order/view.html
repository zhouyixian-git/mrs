<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title>订单详情</title>

    <link rel="shortcut icon" href="__PUBLIC__favicon.ico">
    <link href="__CSS__/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="__CSS__/font-awesome.min.css?v=4.4.0" rel="stylesheet">
    <link href="__CSS__/animate.css" rel="stylesheet">
    <link href="__CSS__/style.css?v=4.1.0" rel="stylesheet">
    <style>
        body{overflow-y: hidden;}
        .ibox-content{height: auto;}
        body{
            overflow-y: auto;
        }
        .ibox-title{
            margin-bottom: 20px;
            border: none;
            border-bottom: solid #e7eaec 1px;
        }

    </style>
</head>

<body class="gray-bg">
<div class="row wrapper wrapper-content animated fadeInRight clearfix">
    <div class="col-sm-8 ">
        <div class="ibox float-e-margins ">
            <div class="ibox-content clearfix">
                <div class="ibox-title col-sm-12">
                    <h3>订单信息
                        <button style="float: right;" type="button"class="btn btn-sm btn-default" onclick="history.back(-1);return false;">返回</button>
                    </h3>
                </div>
                <div class="col-sm-12 clearfix">
                    <div class="col-sm-12 form-horizontal clearfix">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">订单号：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.order_sn}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">支付订单号：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.pay_order_sn}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">用户名：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.user_name}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">订单状态：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {if condition="$order.order_status eq 1"}
                                    <span style="color: #23c6c8;">待付款</span>
                                    {elseif condition="$order.order_status eq 2"}
                                    <span style="color: #1c84c6;">待发货</span>
                                    {elseif condition="$order.order_status eq 3"}
                                    <span style="color: #f8ac59;">已发货</span>
                                    {elseif condition="$order.order_status eq 4"}
                                    <span style="color: #1ab394;">已收货</span>
                                    {elseif condition="$order.order_status eq 5"}
                                    <span style="color: #ed5565;">已取消</span>
                                    {else/}
                                    <span style="color: yellow;">未知</span>
                                    {/if}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">支付状态：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {if condition="$order.pay_status eq 1"}
                                    <span style="color: #23c6c8;">未付款</span>
                                    {elseif condition="$order.pay_status eq 2"}
                                    <span style="color: #f8ac59;">已付款</span>
                                    {else/}
                                    <span style="color: yellow;">未知</span>
                                    {/if}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">发货状态：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {if condition="$order.shipping_status eq 1"}
                                    <span style="color: #23c6c8;">未发货</span>
                                    {elseif condition="$order.shipping_status eq 2"}
                                    <span style="color: #f8ac59;">已发货</span>
                                    {else/}
                                    <span style="color: yellow;">未知</span>
                                    {/if}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">退款状态：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {if condition="$order.refund_status eq 1"}
                                    <span style="color: #f8ac59;">没有退款</span>
                                    {elseif condition="$order.refund_status eq 2"}
                                    <span style="color: #1c84c6;">买家申请退款</span>
                                    {elseif condition="$order.refund_status eq 3"}
                                    <span style="color: #23c6c8;">退款中</span>
                                    {elseif condition="$order.refund_status eq 4"}
                                    <span style="color: #ed5565;">卖家拒绝退款</span>
                                    {elseif condition="$order.refund_status eq 5"}
                                    <span style="color: #1ab394;">退款成功</span>
                                    {else/}
                                    <span style="color: yellow;">未知</span>
                                    {/if}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">退货状态：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {if condition="$order.sales_status eq 1"}
                                    <span style="color: #f8ac59;">没有退货</span>
                                    {elseif condition="$order.sales_status eq 2"}
                                    <span style="color: #1c84c6;">买家申请退货</span>
                                    {elseif condition="$order.sales_status eq 3"}
                                    <span style="color: #23c6c8;">退货中</span>
                                    {elseif condition="$order.sales_status eq 4"}
                                    <span style="color: #ed5565;">卖家拒绝退货</span>
                                    {elseif condition="$order.sales_status eq 5"}
                                    <span style="color: #1ab394;">退货成功</span>
                                    {else/}
                                    <span style="color: yellow;">未知</span>
                                    {/if}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">处理状态：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {if condition="$order.accept_status eq 1"}
                                    <span style="color: #f8ac59;">未处理</span>
                                    {elseif condition="$order.accept_status eq 2"}
                                    <span style="color: #1c84c6;">已处理</span>
                                    {else/}
                                    <span style="color: yellow;">未知</span>
                                    {/if}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">支付方式：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {if condition="$order.pay_type eq 1"}
                                    <span>积分抵扣</span>
                                    {elseif condition="$order.pay_type eq 2"}
                                    <span>积分+微信支付</span>
                                    {else/}
                                    <span style="color: yellow;">未知</span>
                                    {/if}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">订单金额：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.order_amount}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">配送金额：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.shipping_amount}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">积分金额：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.integral_amount}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">现金金额：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.cash_amount}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">收货人：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.consignee}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">收货人联系电话：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.telephone}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">收货地址：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.address}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">快递公司：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.courier_company}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">快递单号：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.courier_number}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">创建时间：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.create_time|dateTime}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">支付时间：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.pay_time|dateTime}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">发货时间：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.shipping_time|dateTime}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">订单取消时间：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.cancel_time|dateTime}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">确认收货时间：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.confirm_time|dateTime}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">申请退货/退款理由：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.refund_reason}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">订单备注：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.order_remark}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">售后货物状态：</label>
                                <div class="col-sm-8 control-label" style="text-align: left">
                                    {$order.refund_goods_status}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="ibox-content clearfix">
                <div class="ibox-title col-sm-12">
                    <h3>订单商品</h3>
                </div>
                <table class="table table-bordered table-hover">
                    <thead>
                    <tr>
                        <th>商品名称</th>
                        <th>商品图片</th>
                        <th>商品数量</th>
                        <th>商品价格</th>
                    </tr>
                    </thead>
                    <tbody>
                    {foreach $order.orderGoods as $key => $goodsInfo}
                    <tr>
                        <td>{$goodsInfo.goods_name}</td>
                        <td>
                            <a href="{$goodsInfo.goods_m_list_image}" target="_blank">
                                <img src="{$goodsInfo.goods_m_list_image}" style="width: 60px;height: 60px;">
                            </a>
                        </td>
                        <td>{$goodsInfo.goods_num}</td>
                        <td>{$goodsInfo.goods_price}</td>
                    </tr>
                    {/foreach}
                    </tbody>
                </table>
            </div>

            <div class="ibox-content clearfix">
                <div class="ibox-title col-sm-12">
                    <h3>订单动作</h3>
                </div>
                <table class="table table-bordered table-hover">
                    <thead>
                    <tr>
                        <th>动作名称</th>
                        <th>用户名称</th>
                        <th>备注</th>
                        <th>创建时间</th>
                    </tr>
                    </thead>
                    <tbody>
                    {foreach $order.orderAction as $key => $orderActionInfo}
                    <tr>
                        <td>{$orderActionInfo.action_name}</td>
                        <td>{$orderActionInfo.action_user_name}</td>
                        <td>{$orderActionInfo.action_remark}</td>
                        <td>{$orderActionInfo.create_time|dateTime}</td>
                    </tr>
                    {/foreach}
                    </tbody>
                </table>
            </div>

            {if condition="in_array($order.order_status, [2, 3, 4])"}
            <div class="ibox-content clearfix">
                <div class="ibox-title col-sm-12">
                    <h3>操作</h3>
                </div>
                {if condition="$order.order_status eq 2"}
                <button type="button"class="btn btn-sm btn-success" onclick="doShipping({$order.order_id})">发货</button>
                {/if}
                {if condition="$order.pay_status eq 2 && in_array($order.refund_status, [2, 3])"}
                <button type="button"class="btn btn-sm btn-success" onclick="doRefund({$order.order_id})">退款</button>
                {/if}
                {if condition="$order.shipping_status eq 2 && in_array($order.sales_status, [2, 3])"}
                <button type="button"class="btn btn-sm btn-success" onclick="doSales({$order.order_id})">退货</button>
                {/if}
            </div>
            {/if}
        </div>
    </div>
</div>

<!-- 全局js -->
<script src="__JS__/jquery.min.js?v=2.1.4"></script>
<script src="__JS__/bootstrap.min.js?v=3.3.6"></script>
<script src="__JS__/form_util.js"></script>

<script src="__JS__/plugins/layer/layer.min.js"></script>
<script>
    /**
     * 订单发货
     * @param order_id
     */
    function doShipping(order_id){
        layer.open({
            type: 2,
            title: '订单发货',
            area: ['400px', '300px'],
            content: "{:url('admin/admin/order/shipping')}?order_id=" + order_id
        });
    }

    /**
     * 订单退款
     * @param order_id
     */
    function doRefund(order_id){

    }

    /**
     * 订单退货
     * @param order_id
     */
    function doSales(order_id){

    }

</script>
</body>

</html>
